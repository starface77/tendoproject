import{r as c,z as h,j as e,a4 as n,a5 as u,X as j}from"./index-U3rPQCjX.js";var g={};const N=()=>{const[r,d]=c.useState([]),[x,i]=c.useState(!0),{user:b,isAuthenticated:l}=h();c.useEffect(()=>{l&&o()},[l]);const o=async()=>{try{i(!0);const s=await fetch(`${g.REACT_APP_API_URL||"http://localhost:5000"}/api/v1/notifications?type=customer_support_reply`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(s.ok){const t=await s.json();t.success&&d(t.data.notifications)}}catch(s){console.error("Ошибка загрузки сообщений:",s)}finally{i(!1)}},m=s=>{const t=new Date(s),a=Math.floor((new Date-t)/(1e3*60));return a<1?"Только что":a<60?`${a} мин назад`:a<1440?`${Math.floor(a/60)} ч назад`:t.toLocaleDateString("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})};return l?e.jsxs("div",{className:"container-custom py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center",children:[e.jsx(n,{className:"mr-3 text-blue-600"}),"Сообщения поддержки"]}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Ваши переписки с службой поддержки"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:r.length}),e.jsx("div",{className:"text-sm text-gray-500",children:"Всего сообщений"})]})]}),e.jsx("div",{className:"space-y-6",children:x?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Загрузка сообщений..."})]}):r.length===0?e.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[e.jsx(n,{className:"mx-auto h-16 w-16 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"У вас пока нет сообщений"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Здесь будут отображаться ответы от службы поддержки"}),e.jsx("a",{href:"/contacts",className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Написать в поддержку"})]}):r.map(s=>{var t;return e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex items-center justify-center w-10 h-10 bg-blue-100 rounded-full",children:e.jsx(u,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:s.title.ru}),e.jsx("p",{className:"text-sm text-gray-500",children:m(s.createdAt)})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(j,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-500",children:s.status==="read"?"Прочитано":"Не прочитано"})]})]})}),e.jsxs("div",{className:"px-6 py-4",children:[e.jsx("p",{className:"text-gray-700 leading-relaxed",children:s.message.ru}),((t=s.relatedData)==null?void 0:t.contact)&&e.jsx("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg border border-blue-200",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Тема обращения:"})," ",s.relatedData.contact.subject]})})]}),e.jsx("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{className:"text-sm text-blue-600 hover:text-blue-700 font-medium",onClick:()=>{},children:"Посмотреть историю"}),e.jsx("button",{className:"text-sm text-gray-600 hover:text-gray-700",onClick:()=>{},children:"Ответить"})]}),e.jsx("a",{href:"/contacts",className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"Новое обращение"})]})})]},s._id)})})]}):e.jsx("div",{className:"container-custom py-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Войдите в аккаунт"}),e.jsx("p",{className:"text-gray-600",children:"Для просмотра сообщений необходимо войти в систему"})]})})};export{N as default};
