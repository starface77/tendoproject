import{r as l,z as M,a2 as i,j as s,Z as N,h as D,a3 as E,C as U}from"./index-U3rPQCjX.js";const P=()=>{const[u,r]=l.useState([]),[n,g]=l.useState(!0),[c,y]=l.useState("all"),[x,p]=l.useState(1),[b,j]=l.useState(!0),[m,v]=l.useState({}),{isAuthenticated:h}=M();l.useEffect(()=>{h&&(f(),o())},[h,c,x]);const f=async()=>{try{g(!0);const e={page:x,limit:20};c==="unread"&&(e.unreadOnly=!0),c==="archived"&&(e.archived=!0);const t=await i.getNotifications(e);t.success&&(r(x===1?t.data.notifications:a=>[...a,...t.data.notifications]),j(t.data.pagination.page<t.data.pagination.pages))}catch(e){console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:",e)}finally{g(!1)}},o=async()=>{try{const e=await i.getNotificationStats();e.success&&v(e.data)}catch(e){console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:",e)}},w=async e=>{try{await i.markNotificationAsRead(e),r(t=>t.map(a=>a._id===e?{...a,isRead:!0}:a)),o()}catch(t){console.error("–û—à–∏–±–∫–∞ –æ—Ç–º–µ—Ç–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:",t)}},_=async e=>{try{await i.archiveNotification(e),r(t=>t.filter(a=>a._id!==e)),o()}catch(t){console.error("–û—à–∏–±–∫–∞ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:",t)}},k=async e=>{try{await i.deleteNotification(e),r(t=>t.filter(a=>a._id!==e)),o()}catch(t){console.error("–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:",t)}},A=async()=>{try{await i.markAllNotificationsAsRead(),r(e=>e.map(t=>({...t,isRead:!0}))),o()}catch(e){console.error("–û—à–∏–±–∫–∞ –æ—Ç–º–µ—Ç–∫–∏ –≤—Å–µ—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:",e)}},R=e=>{y(e),p(1),r([])},C=()=>{!n&&b&&p(e=>e+1)},S=e=>({customer_payment_success:"‚úÖ",seller_payment_received:"üí∞",admin_payment_processed:"üìä",customer_order_update:"üõí",seller_order_received:"üì¶",admin_order_created:"üìã",customer_support_reply:"üí¨",admin_new_message:"üìß"})[e]||"üîî",$=e=>({low:"text-gray-500",normal:"text-blue-600",high:"text-orange-600",urgent:"text-red-600"})[e]||"text-blue-600",F=e=>{const t=new Date(e),d=Math.floor((new Date-t)/(1e3*60));return d<1?"–¢–æ–ª—å–∫–æ —á—Ç–æ":d<60?`${d} –º–∏–Ω –Ω–∞–∑–∞–¥`:d<1440?`${Math.floor(d/60)} —á –Ω–∞–∑–∞–¥`:t.toLocaleDateString("ru-RU")};return h?s.jsxs("div",{className:"container-custom py-8",children:[s.jsxs("div",{className:"flex items-center justify-between mb-8",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center",children:[s.jsx(N,{className:"mr-3 text-blue-600"}),"–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è"]}),s.jsx("p",{className:"text-gray-600 mt-2",children:"–û—Å—Ç–∞–≤–∞–π—Ç–µ—Å—å –≤ –∫—É—Ä—Å–µ –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π –≤–∞—à–µ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞"})]}),s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-blue-600",children:m.total||0}),s.jsx("div",{className:"text-sm text-gray-500",children:"–í—Å–µ–≥–æ"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-orange-600",children:m.unread||0}),s.jsx("div",{className:"text-sm text-gray-500",children:"–ù–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ"})]}),m.unread>0&&s.jsx("button",{onClick:A,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"–û—Ç–º–µ—Ç–∏—Ç—å –≤—Å–µ –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ"})]})]}),s.jsxs("div",{className:"flex items-center space-x-4 mb-6",children:[s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"–§–∏–ª—å—Ç—Ä:"}),["all","unread","read","archived"].map(e=>s.jsxs("button",{onClick:()=>R(e),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${c===e?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[e==="all"&&"–í—Å–µ",e==="unread"&&"–ù–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ",e==="read"&&"–ü—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ",e==="archived"&&"–ê—Ä—Ö–∏–≤"]},e))]}),s.jsx("div",{className:"space-y-4",children:u.length===0&&!n?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(N,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –Ω–µ –Ω–∞–π–¥–µ–Ω–æ"}),s.jsx("p",{className:"text-gray-500",children:c==="all"?"–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π":`–ù–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "${c}"`})]}):u.map(e=>{var t;return s.jsxs("div",{className:`bg-white rounded-lg border p-6 hover:shadow-md transition-shadow ${e.isRead?"border-gray-200":"border-blue-200 bg-blue-50"}`,children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-start space-x-4",children:[s.jsx("span",{className:"text-3xl",children:S(e.type)}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[s.jsx("h4",{className:`text-lg font-semibold ${$(e.priority)}`,children:e.title.ru}),!e.isRead&&s.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:"–ù–æ–≤–æ–µ"})]}),s.jsx("p",{className:"text-gray-700 mb-3",children:e.message.ru}),s.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[s.jsx("span",{children:F(e.createdAt)}),s.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${e.priority==="urgent"?"bg-red-100 text-red-800":e.priority==="high"?"bg-orange-100 text-orange-800":e.priority==="normal"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:e.priority==="urgent"?"–°—Ä–æ—á–Ω–æ":e.priority==="high"?"–í–∞–∂–Ω–æ":e.priority==="normal"?"–û–±—ã—á–Ω–æ":"–ù–∏–∑–∫–∏–π"})]})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[!e.isRead&&s.jsx("button",{onClick:()=>w(e._id),className:"p-2 text-gray-400 hover:text-green-600 transition-colors",title:"–û—Ç–º–µ—Ç–∏—Ç—å –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ–µ",children:s.jsx(D,{className:"h-5 w-5"})}),s.jsx("button",{onClick:()=>_(e._id),className:"p-2 text-gray-400 hover:text-orange-600 transition-colors",title:"–ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å",children:s.jsx(E,{className:"h-5 w-5"})}),s.jsx("button",{onClick:()=>k(e._id),className:"p-2 text-gray-400 hover:text-red-600 transition-colors",title:"–£–¥–∞–ª–∏—Ç—å",children:s.jsx(U,{className:"h-5 w-5"})})]})]}),((t=e.metadata)==null?void 0:t.actionUrl)&&s.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:s.jsx("a",{href:e.metadata.actionUrl,className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:e.metadata.actionText})})]},e._id)})}),b&&s.jsx("div",{className:"text-center mt-8",children:s.jsx("button",{onClick:C,disabled:n,className:"px-6 py-3 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:n?"–ó–∞–≥—Ä—É–∑–∫–∞...":"–ó–∞–≥—Ä—É–∑–∏—Ç—å –µ—â–µ"})}),n&&s.jsxs("div",{className:"text-center py-8",children:[s.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),s.jsx("p",{className:"text-gray-500 mt-2",children:"–ó–∞–≥—Ä—É–∑–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π..."})]})]}):s.jsx("div",{className:"container-custom py-8",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"–í–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç"}),s.jsx("p",{className:"text-gray-600",children:"–î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É"})]})})};export{P as default};
