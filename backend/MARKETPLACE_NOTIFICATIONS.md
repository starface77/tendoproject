# üîî –°–ò–°–¢–ï–ú–ê –£–í–ï–î–û–ú–õ–ï–ù–ò–ô –ú–ê–†–ö–ï–¢–ü–õ–ï–ô–°–ê

–ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –¥–ª—è –≤—Å–µ—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞: –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π, –ø—Ä–æ–¥–∞–≤—Ü–æ–≤ –∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤.

## üìã –û–°–û–ë–ï–ù–ù–û–°–¢–ò

### üéØ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- **–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞** ‚Üí —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–∫—É–ø–∞—Ç–µ–ª—é, –ø—Ä–æ–¥–∞–≤—Ü—É, –∞–¥–º–∏–Ω–∞–º
- **–£—Å–ø–µ—à–Ω–∞—è –æ–ø–ª–∞—Ç–∞** ‚Üí —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤—Å–µ–º —É—á–∞—Å—Ç–Ω–∏–∫–∞–º
- **–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞** ‚Üí —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –¥–æ—Å—Ç–∞–≤–∫–µ, –æ—Ç–º–µ–Ω–µ –∏ —Ç.–¥.
- **–û—à–∏–±–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π** ‚Üí —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –ø—Ä–æ–±–ª–µ–º–∞—Ö

### üì± –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∫–∞–Ω–∞–ª—ã –¥–æ—Å—Ç–∞–≤–∫–∏
- **–í –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏** (in-app) - –æ—Å–Ω–æ–≤–Ω–æ–π –∫–∞–Ω–∞–ª
- **Email** - –¥–ª—è –≤–∞–∂–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- **SMS** - –¥–ª—è —Å—Ä–æ—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- **Telegram** - –¥–ª—è –ø—Ä–æ–¥–∞–≤—Ü–æ–≤
- **Push** - –º–æ–±–∏–ª—å–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

### üåç –ú–Ω–æ–≥–æ—è–∑—ã—á–Ω–æ—Å—Ç—å
- –†—É—Å—Å–∫–∏–π (ru)
- –£–∑–±–µ–∫—Å–∫–∏–π (uz) 
- –ê–Ω–≥–ª–∏–π—Å–∫–∏–π (en)

### üé® –£–º–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤
- **Low** - –æ–±—ã—á–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- **Normal** - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- **High** - –≤–∞–∂–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- **Urgent** - —Å—Ä–æ—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è

## üèóÔ∏è –ê–†–•–ò–¢–ï–ö–¢–£–†–ê

### –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
```
Notification.js - –æ—Å–Ω–æ–≤–Ω–∞—è –º–æ–¥–µ–ª—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
User.js - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å —Ä–æ–ª—è–º–∏
Order.js - –∑–∞–∫–∞–∑—ã
Payment.js - –ø–ª–∞—Ç–µ–∂–∏
```

### –°–µ—Ä–≤–∏—Å—ã
```
notificationService.js - –ª–æ–≥–∏–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
webhookController.js - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤–Ω–µ—à–Ω–∏—Ö webhook
```

### API –º–∞—Ä—à—Ä—É—Ç—ã
```
/notifications - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏
/webhooks - –≤–Ω–µ—à–Ω–∏–µ webhook
```

## üöÄ –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–ï

### 1. –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã

```javascript
const NotificationService = require('./services/notificationService');

// –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç—ã
await NotificationService.sendPaymentNotifications(paymentData);
```

### 2. –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –∑–∞–∫–∞–∑–µ

```javascript
// –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–∫–∞–∑–∞
await NotificationService.sendOrderNotifications(orderData);

// –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞
await NotificationService.sendOrderStatusNotification(orderId, 'shipped', 'confirmed');
```

### 3. –ü–æ–ª—É—á–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```javascript
const notifications = await NotificationService.getUserNotifications(userId, {
  page: 1,
  limit: 20,
  unreadOnly: false
});
```

## üîó WEBHOOK –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø

### Endpoint –¥–ª—è –ø–ª–∞—Ç–µ–∂–Ω—ã—Ö —Å–∏—Å—Ç–µ–º
```
POST /api/v1/webhooks/payment
```

### –§–æ—Ä–º–∞—Ç webhook
```json
{
  "paymentId": "64f8a1b2c3d4e5f6a7b8c9d0",
  "status": "completed",
  "transactionId": "TXN_123456",
  "amount": 150000,
  "method": "click",
  "signature": "hmac_signature",
  "timestamp": "2024-01-15T10:30:00Z"
}
```

### –°—Ç–∞—Ç—É—Å—ã –ø–ª–∞—Ç–µ–∂–µ–π
- `completed` / `success` - —É—Å–ø–µ—à–Ω–∞—è –æ–ø–ª–∞—Ç–∞
- `failed` / `declined` - –Ω–µ—É–¥–∞—á–Ω–∞—è –æ–ø–ª–∞—Ç–∞
- `pending` - –æ–∂–∏–¥–∞—é—â–∞—è –æ–ø–ª–∞—Ç–∞
- `refunded` - –≤–æ–∑–≤—Ä–∞—Ç —Å—Ä–µ–¥—Å—Ç–≤

## üì± –§–†–û–ù–¢–ï–ù–î –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –∫–æ–ª–æ–∫–æ–ª—å—á–∏–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
```jsx
import NotificationBell from '../components/ui/NotificationBell';

// –í –Ω–∞–≤–±–∞—Ä–µ
<NotificationBell />
```

### –°—Ç—Ä–∞–Ω–∏—Ü–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
```jsx
import NotificationsPage from '../pages/NotificationsPage';

// –í —Ä–æ—É—Ç–∏–Ω–≥–µ
<Route path="/notifications" element={<NotificationsPage />} />
```

### API –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
```javascript
import { notificationsApi } from '../services/api';

// –ü–æ–ª—É—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
const notifications = await notificationsApi.getNotifications();

// –û—Ç–º–µ—Ç–∏—Ç—å –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ–µ
await notificationsApi.markNotificationAsRead(id);

// –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
const stats = await notificationsApi.getNotificationStats();
```

## üîß –ù–ê–°–¢–†–û–ô–ö–ê

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```env
# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
NOTIFICATION_EMAIL_ENABLED=true
NOTIFICATION_SMS_ENABLED=false
NOTIFICATION_TELEGRAM_ENABLED=true
NOTIFICATION_PUSH_ENABLED=false

# Webhook —Å–µ–∫—Ä–µ—Ç—ã
WEBHOOK_SECRET=your_webhook_secret
CLICK_WEBHOOK_SECRET=click_secret
PAYME_WEBHOOK_SECRET=payme_secret
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø–ª–∞—Ç–µ–∂–Ω—ã–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏

#### Click.uz
```javascript
// –í webhook –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ
if (method === 'click') {
  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ Click
  const isValidSignature = verifyClickSignature(payload, signature);
  if (!isValidSignature) {
    return res.status(401).json({ error: 'Invalid signature' });
  }
}
```

#### Payme
```javascript
// –í webhook –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ
if (method === 'payme') {
  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ Payme
  const isValidSignature = verifyPaymeSignature(payload, signature);
  if (!isValidSignature) {
    return res.status(401).json({ error: 'Invalid signature' });
  }
}
```

## üìä –ú–û–ù–ò–¢–û–†–ò–ù–ì –ò –ê–ù–ê–õ–ò–¢–ò–ö–ê

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
- –ù–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ
- –ü–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º
- –ü–æ –∫–∞–Ω–∞–ª–∞–º –¥–æ—Å—Ç–∞–≤–∫–∏

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
```javascript
console.log('üîî –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã:', paymentId);
console.log('‚úÖ –°–æ–∑–¥–∞–Ω–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:', notifications.length);
console.log('‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏:', error.message);
```

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

### –¢–µ—Å—Ç–æ–≤—ã–π webhook
```bash
curl -X POST http://localhost:5000/api/v1/webhooks/test \
  -H "Content-Type: application/json" \
  -d '{
    "test": "data",
    "timestamp": "2024-01-15T10:30:00Z"
  }'
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
```bash
curl http://localhost:5000/api/v1/webhooks/status
```

## üîí –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–µ–π webhook
- HMAC-SHA256 –ø–æ–¥–ø–∏—Å–∏ –¥–ª—è –≤—Å–µ—Ö webhook
- –°–µ–∫—Ä–µ—Ç–Ω—ã–µ –∫–ª—é—á–∏ –¥–ª—è –∫–∞–∂–¥–æ–π –ø–ª–∞—Ç–µ–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã
- –í–∞–ª–∏–¥–∞—Ü–∏—è timestamp –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è replay –∞—Ç–∞–∫

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è API
- JWT —Ç–æ–∫–µ–Ω—ã –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –†–æ–ª–∏ –∏ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
- –ó–∞—â–∏—Ç–∞ –æ—Ç CSRF –∞—Ç–∞–∫

## üìà –†–ê–°–®–ò–†–ï–ù–ò–ï –°–ò–°–¢–ï–ú–´

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∫–∞–Ω–∞–ª–æ–≤
```javascript
// –í notificationService.js
static async sendNewChannelNotification(notification) {
  try {
    // –õ–æ–≥–∏–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —á–µ—Ä–µ–∑ –Ω–æ–≤—ã–π –∫–∞–Ω–∞–ª
    await notification.markAsSent('new_channel');
  } catch (error) {
    await notification.markAsFailed('new_channel', error.message);
  }
}
```

### –ù–æ–≤—ã–µ —Ç–∏–ø—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
```javascript
// –í –º–æ–¥–µ–ª–∏ Notification.js
enum: [
  // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–∏–ø—ã
  'new_type_1',
  'new_type_2'
]
```

### –ö–∞—Å—Ç–æ–º–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã
```javascript
// –í notificationService.js
static getCustomNotificationTemplate(type, data) {
  // –õ–æ–≥–∏–∫–∞ –¥–ª—è –∫–∞—Å—Ç–æ–º–Ω—ã—Ö —à–∞–±–ª–æ–Ω–æ–≤
  return {
    title: customTitle,
    message: customMessage,
    metadata: customMetadata
  };
}
```

## üö® –£–°–¢–†–ê–ù–ï–ù–ò–ï –ù–ï–ü–û–õ–ê–î–û–ö

### –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

#### –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞
2. –£–±–µ–¥–∏—Ç—å—Å—è –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞–Ω–∞–ª–æ–≤ –¥–æ—Å—Ç–∞–≤–∫–∏

#### Webhook –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å URL endpoint
2. –£–±–µ–¥–∏—Ç—å—Å—è –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –ø–æ–¥–ø–∏—Å–∏
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö

#### –û—à–∏–±–∫–∏ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ MongoDB
2. –£–±–µ–¥–∏—Ç—å—Å—è –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Å—Ö–µ–º
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã

### –õ–æ–≥–∏ –∏ –æ—Ç–ª–∞–¥–∫–∞
```javascript
// –í–∫–ª—é—á–∏—Ç—å –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
console.log('üîç Debug info:', {
  notification: notification._id,
  recipient: notification.recipient,
  channels: notification.channels,
  data: notification.relatedData
});
```

## üìö –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –†–ï–°–£–†–°–´

- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è MongoDB](https://docs.mongodb.com/)
- [Express.js –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](https://expressjs.com/)
- [React –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](https://reactjs.org/)
- [Webhook best practices](https://webhooks.fyi/)

---

**üéØ –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** 

–í—Å–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤—Å–µ–º —É—á–∞—Å—Ç–Ω–∏–∫–∞–º –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞ –ø—Ä–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö —Å–æ–±—ã—Ç–∏—è—Ö. –°–∏—Å—Ç–µ–º–∞ –ª–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è–µ—Ç—Å—è –∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –ø–æ–¥ –≤–∞—à–∏ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏.

